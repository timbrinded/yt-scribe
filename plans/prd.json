{
	"name": "YTScribe - YouTube Video Knowledge Base with LLM Chat",
	"quality_gates": ["bun run typecheck", "bun test", "bun run lint"],
	"tasks": [
		{
			"category": "functional",
			"description": "[Effect-TS] Create test layer infrastructure",
			"steps": [
				"Run `bun add -d @effect/vitest`",
				"Update src/effect/layers/Test.ts to export makeTestLayer factory",
				"Create default mock implementations: Database.Test, OpenAI.Test, YouTube.Test, Progress.Test, Transcription.Test, Chat.Test",
				"Run `bun run typecheck`"
			],
			"passes": false
		},
		{
			"category": "functional",
			"description": "[Effect-TS] Add Pipeline service unit tests with mock DI",
			"steps": [
				"Create `tests/effect/services/Pipeline.test.ts`",
				"Create test-specific mock layers for YouTube, Transcription",
				"Compose test layer replacing real services: makeTestLayer({ youtube: MockYouTube, transcription: MockTranscription })",
				"Write tests using Effect.provide(TestLayer)",
				"Test: processVideo succeeds with mocked services",
				"Test: processVideo returns VideoNotFoundError for missing video",
				"Test: processVideo marks video as failed on transcription error",
				"Run `bun test tests/effect/services/`"
			],
			"passes": false
		},
		{
			"category": "functional",
			"description": "[Effect-TS] Add API integration tests with full test layer",
			"steps": [
				"Create `tests/effect/api/videos.test.ts`",
				"Use makeTestLayer() to create fully mocked environment",
				"Use Effect HttpClient to make requests against test server",
				"Test: POST /videos creates video and returns 201",
				"Test: POST /videos returns 400 for invalid YouTube URL",
				"Test: GET /videos returns user's videos only",
				"Test: Unauthorized request returns 401",
				"Run `bun test tests/effect/api/`"
			],
			"passes": false
		},
		{
			"category": "observability",
			"description": "Add basic analytics tracking",
			"steps": [
				"Create analytics table: id, userId, event, properties (JSON), createdAt",
				"Add trackEvent(userId, event, properties) function",
				"Track: video_added, transcription_completed, chat_message_sent",
				"Create admin endpoint GET /api/admin/analytics (protected)",
				"Verify events are recorded"
			],
			"passes": false
		}
	]
}
