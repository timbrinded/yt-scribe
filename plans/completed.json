[
	{
		"category": "functional",
		"description": "Initialize Bun project with TypeScript, Biome linting, and Vitest testing",
		"steps": [
			"Run `bun init` in project root",
			"Install dev dependencies: `bun add -d typescript @types/bun vitest @biomejs/biome`",
			"Create tsconfig.json with strict mode enabled",
			"Create biome.json with recommended rules",
			"Create vitest.config.ts",
			"Add scripts to package.json: typecheck, test, lint, format",
			"Run `bun run typecheck` and verify it passes",
			"Run `bun run lint` and verify it passes"
		],
		"completed_at": "2026-02-01"
	},
	{
		"category": "functional",
		"description": "Set up Drizzle ORM with SQLite and create initial schema for users table",
		"steps": [
			"Install Drizzle: `bun add drizzle-orm` and `bun add -d drizzle-kit @libsql/client` (using bun:sqlite for runtime)",
			"Create src/db/schema.ts with users table (id, email, name, avatarUrl, createdAt)",
			"Create src/db/index.ts to initialize SQLite connection using bun:sqlite",
			"Create drizzle.config.ts pointing to schema",
			"Add db:push and db:generate scripts to package.json",
			"Run `bun run db:push` to create database",
			"Verify data/ytscribe.db file is created",
			"Run `bun run typecheck` to verify schema types"
		],
		"completed_at": "2026-02-01"
	},
	{
		"category": "functional",
		"description": "Add videos table schema with foreign key to users",
		"steps": [
			"Add videos table to schema: id, userId, youtubeUrl, youtubeId, title, duration, thumbnailUrl, status (pending/processing/completed/failed), createdAt, updatedAt",
			"Run `bun run db:push` to apply changes",
			"Write test in tests/db/schema.test.ts verifying table creation",
			"Run `bun test` and verify test passes"
		],
		"completed_at": "2026-02-01"
	},
	{
		"category": "functional",
		"description": "Add transcripts table schema linked to videos",
		"steps": [
			"Add transcripts table: id, videoId, content (full text), segments (JSON array with start/end timestamps and text), language, createdAt",
			"Run `bun run db:push` to apply changes",
			"Write test verifying transcript can reference video",
			"Run `bun test` and verify test passes"
		],
		"completed_at": "2026-02-01"
	},
	{
		"category": "functional",
		"description": "Add chat_sessions and messages tables for conversation history",
		"steps": [
			"Add chat_sessions table: id, videoId, userId, title, createdAt, updatedAt",
			"Add messages table: id, sessionId, role (user/assistant), content, createdAt",
			"Run `bun run db:push`",
			"Write test verifying message chain integrity",
			"Run `bun test` and verify passes"
		],
		"completed_at": "2026-02-01"
	},
	{
		"category": "functional",
		"description": "Set up Elysia server with health check endpoint",
		"steps": [
			"Install Elysia: `bun add elysia @elysiajs/cors`",
			"Create src/server.ts with Elysia app",
			"Add GET /health endpoint returning { status: 'ok', timestamp }",
			"Add start script to package.json",
			"Run `bun run start` in background",
			"Run `curl http://localhost:3000/health` and verify JSON response",
			"Stop server and verify clean shutdown"
		],
		"completed_at": "2026-02-01"
	},
	{
		"category": "security",
		"description": "Implement OAuth with Google provider using arctic library",
		"steps": [
			"Install arctic: `bun add arctic`",
			"Create src/auth/google.ts with Google OAuth client setup",
			"Add GET /auth/google endpoint that redirects to Google consent",
			"Add GET /auth/google/callback that exchanges code for tokens",
			"Create or update user in database from Google profile",
			"Generate session token and set httpOnly cookie",
			"Verify redirect to Google works (manual test with real credentials)",
			"Run `bun run typecheck`"
		],
		"completed_at": "2026-02-01"
	},
	{
		"category": "security",
		"description": "Add session management with secure cookies",
		"steps": [
			"Add sessions table: id, userId, token, expiresAt, createdAt",
			"Create src/auth/session.ts with createSession, validateSession, deleteSession",
			"Add GET /auth/me endpoint returning current user or 401",
			"Add POST /auth/logout endpoint clearing session",
			"Write tests for session creation and validation",
			"Run `bun test` and verify passes"
		],
		"completed_at": "2026-02-01"
	},
	{
		"category": "security",
		"description": "Create auth middleware for protected routes",
		"steps": [
			"Create src/middleware/auth.ts Elysia plugin",
			"Middleware should extract session token from cookie",
			"Validate session and attach user to context",
			"Return 401 for invalid/missing sessions",
			"Write test with mock request verifying 401 without auth",
			"Write test with valid session verifying user attached",
			"Run `bun test`"
		],
		"completed_at": "2026-02-01"
	},
	{
		"category": "functional",
		"description": "Create YouTube URL validation and metadata extraction service",
		"steps": [
			"Create src/services/youtube.ts",
			"Add function to validate YouTube URL formats (youtu.be, youtube.com/watch, etc)",
			"Add function to extract video ID from URL",
			"Shell out to yt-dlp with --dump-json to get metadata (title, duration, thumbnail)",
			"Write tests for URL validation with various formats",
			"Write test for metadata extraction with a real public video",
			"Run `bun test`"
		],
		"completed_at": "2026-02-01"
	},
	{
		"category": "functional",
		"description": "Implement video download service using yt-dlp",
		"steps": [
			"Add function downloadAudio(youtubeUrl, outputPath) to youtube service",
			"Use yt-dlp to download audio-only in m4a/mp3 format",
			"Store in data/downloads/{videoId}.m4a",
			"Return file path on success, throw on failure",
			"Write test downloading a short public video",
			"Verify file exists and has audio content",
			"Run `bun test`"
		],
		"completed_at": "2026-02-01"
	},
	{
		"category": "functional",
		"description": "Implement audio transcription using OpenAI Whisper API",
		"steps": [
			"Install OpenAI SDK: `bun add openai`",
			"Create src/services/transcription.ts",
			"Add function transcribeAudio(filePath) that calls OpenAI Whisper API",
			"Parse response into segments with timestamps",
			"Handle API errors gracefully with typed error responses",
			"Write test with a short audio file verifying transcript returned",
			"Run `bun test`"
		],
		"completed_at": "2026-02-01"
	},
	{
		"category": "functional",
		"description": "Create video processing pipeline orchestrating download → transcribe → save",
		"steps": [
			"Create src/services/pipeline.ts",
			"Add processVideo(videoId) function that: fetches video record, downloads audio, transcribes, saves transcript to DB, updates video status",
			"Handle errors by setting status to 'failed'",
			"Clean up temp audio file after processing",
			"Write integration test with mocked OpenAI",
			"Verify database state after successful processing",
			"Run `bun test`"
		],
		"completed_at": "2026-02-01"
	},
	{
		"category": "functional",
		"description": "Add POST /api/videos endpoint to queue new video for processing",
		"steps": [
			"Create src/routes/videos.ts Elysia plugin",
			"POST /api/videos accepts { url } body",
			"Validate URL format, extract YouTube ID",
			"Check for duplicate (same youtubeId + userId)",
			"Create video record with status 'pending'",
			"Trigger pipeline processing (fire and forget for now)",
			"Return video record with 201 status",
			"Write test verifying video creation",
			"Write test verifying duplicate rejection",
			"Run `bun test`"
		],
		"completed_at": "2026-02-01"
	}
]
